# wsMath Random maths worksheets

## Introduction
**wsMath** is a web application that allows to host, define and obtain randomly generated maths worksheets.
It is designed as a micro-service in nodejs around the piworld.es login service.

**Definitions**
---
- **worksheet** = Structure defined by teachers containing a sequence of activities and question generators. 
- **question generator class** = A javascript class which instances are used to produce randomly generated questions. The random generator can be seeded in order to obtain reproducible results. 
- **sheet** = Is the final result presented to the students. It is basically an instance of the **worksheet** after applying the required **question generator classes** and the **exporter** to produce the desired output type.
- **exporter** = a function or class that is called to produce the desired output. The supported outputs are sheets in json, html, latex, pdf and odt.


**Workflow**
---
The logical workflow is the following
1. A registered teacher creates and saves a worksheet. The teacher decides to share by link or publicly this sheet. A sid number is generated to access it. For example _2y3bksq_.
2. A student gets an url link like _/wsmath/g/2y3bksq?type=html&seed=1784b_ from which can view or download the sheet. 
3. Questions answers will be available only if the student configured it in the corresponding worksheet. Alternatively, the teacher can provide a second link like _/wsmath/g/2y3bksq?type=html&seed=1784b&keys=2_ to download the full answers with steps of that sheet. The teacher can configure the worksheet in order to make public the answers from a given date. Please, see the worksheet edition section. 

## Routes
- **/wsmath/**: [all] Home page in which public sheets can be downloaded
- **/wsmath/e**: [teachers only] *My Sheets*, allows to manage sheets defined by teachers.
- **/wsmath/e/_sid_**: [teacher owner only] This route allows to edit a sheet with the given **sheetID** (*sid*)

- **/wsmath/g/_sid_?{options}**: [all] Route to download a sheet instance with a given sid. Options include these query parameters:
    * **type=**_string [default is html]: In which format the sheet must be rendered. The allowed values are: json, latex, html, pdf, odt. 
        * **json**: Is a raw definition of the generated sheet. It is an intermediate format required to generate all the other ones. Since it contains sensible information, it is not available to students.
        * **latex**: Returns a .tex file
        * **html**: Opens a web page (*Recommended type)
        * **pdf**: Downloads a pdf
        * **odt**: Downloads a Libre Office odt (Experimental and buggy). Please use Libre Office instead of Open Office.

    * **seed=**_string_ [optional]: Seed used to initialize the random generator. Calling the route with the same seed multiple times results in exactly the same result. This option can be used to associate a seed for each student. If the seed parameter is not passed, different calls yields different results.
    * **keys=**_number_ [optional]: Which kind of answers must the sheet include. The allowed values are 0=no answer shown, 1=one key per activity, 2=all keys, -1=one with full steps, -2=all answers with full steps.
    This parameter overrides that defined in the worksheet. So, registered users (with role student) will not be able to modify it unless the _keysOpens_ date allows it.
    * **fullname=**_string [optional]: Pass the full name of the student in order to customize the sheet's header.
    * **force=1** [default is 0]: Documents generated with a seed parameter become cached in the server. This can be a problem if the teacher wants to introduce changes in their worksheets. This option allows to bypass the cache and forces the generation of the sheet.

- **/wsmath/r/_sid_**: [teacher owner only] This route allows generate a report of the sheet with the given **sheetID** (*sid*). In particular, the teacher can track the sheets generated by the diferent users (defined by the {seed,fullname} pair)

## Worksheet edition
To be continued...